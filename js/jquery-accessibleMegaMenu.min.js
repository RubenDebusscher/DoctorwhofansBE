(function(e,t,s){"use strict";function a(t,s){this.element=t,this.settings=e.extend({},F,s),this._defaults=F,this._name=k,this.mouseTimeoutID=null,this.focusTimeoutID=null,this.mouseFocused=!1,this.justFocused=!1,this.init()}function n(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}function i(t,s){var a,i,l,o=t.nodeName.toLowerCase();return"area"===o?(a=t.parentNode,i=a.name,!(!t.href||!i||"map"!==a.nodeName.toLowerCase())&&(l=e("img[usemap=#"+i+"]")[0],!!l&&n(l))):(/input|select|textarea|button|object/.test(o)?!t.disabled:"a"===o&&t.href||s)&&n(t)}var l,o,u,r,c,f,h,d,g,p,m,b,C,v,x,y,D,T,E,I,M,k="accessibleMegaMenu",F={uuidPrefix:"accessible-megamenu",menuClass:"accessible-megamenu",topNavItemClass:"accessible-megamenu-top-nav-item",panelClass:"accessible-megamenu-panel",panelGroupClass:"accessible-megamenu-panel-group",hoverClass:"hover",focusClass:"focus",openClass:"open",toggleButtonClass:"accessible-megamenu-toggle",openDelay:0,closeDelay:250,openOnMouseover:!1},N={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38,keyMap:{48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",59:";",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",190:"."}},P=t.clearTimeout,A=t.setTimeout,w=t.opera&&"[object Opera]"===t.opera.toString();a.prototype=(T=0,E=1e3,I="",M="ontouchstart"in t||t.navigator.msMaxTouchPoints,l=function(t){return e(t).closest(":data(plugin_"+k+")").data("plugin_"+k)},o=function(t){t=e(t);var s=this.settings;t.attr("id")||t.attr("id",s.uuidPrefix+"-"+(new Date).getTime()+"-"+ ++T)},u=function(t,a){var n,i=e(t.target),l=this,o=this.settings,u=this.menu,r=i.closest("."+o.topNavItemClass),c=i.hasClass(o.panelClass)?i:i.closest("."+o.panelClass);if(x.call(this,!0),a)if(r=u.find("."+o.topNavItemClass+" ."+o.openClass+":first").closest("."+o.topNavItemClass),r.is(t.relatedTarget)||r.has(t.relatedTarget).length>0)0===r.length&&u.find("[aria-expanded=true]").attr("aria-expanded","false").removeClass(o.openClass).filter("."+o.panelClass).attr("aria-hidden","true");else{if(("mouseout"===t.type||"focusout"===t.type)&&r.has(s.activeElement).length>0)return;r.find("[aria-expanded]").attr("aria-expanded","false").removeClass(o.openClass).filter("."+o.panelClass).attr("aria-hidden","true"),("keydown"===t.type&&t.keyCode===N.ESCAPE||"DOMAttrModified"===t.type)&&(n=r.find(":tabbable:first"),A(function(){u.find("[aria-expanded]."+l.settings.panelClass).off("DOMAttrModified.accessible-megamenu"),n.focus(),l.justFocused=!1},99))}else{P(l.focusTimeoutID),r.siblings().find("[aria-expanded]").attr("aria-expanded","false").removeClass(o.openClass).filter("."+o.panelClass).attr("aria-hidden","true"),r.find("[aria-expanded]").attr("aria-expanded","true").addClass(o.openClass).filter("."+o.panelClass).attr("aria-hidden","false");var f=e("html")[0].scrollTop,h=e("."+o.panelClass+"."+o.openClass).parent().offset().top;f>h&&(e("html")[0].scrollTop=h),"mouseover"===t.type&&i.is(":tabbable")&&1===r.length&&0===c.length&&u.has(s.activeElement).length>0&&(i.focus(),l.justFocused=!1),x.call(l)}},r=function(t){var s=e(t.target).closest(":tabbable"),a=s.closest("."+this.settings.topNavItemClass),n=s.closest("."+this.settings.panelClass);1===a.length&&0===n.length&&1===a.find("."+this.settings.panelClass).length&&(s.hasClass(this.settings.openClass)?this.justFocused?(t.preventDefault(),t.stopPropagation(),this.justFocused=!1):(M||!M&&!this.settings.openOnMouseover)&&(t.preventDefault(),t.stopPropagation(),u.call(this,t,s.hasClass(this.settings.openClass))):(t.preventDefault(),t.stopPropagation(),u.call(this,t),this.justFocused=!1))},c=function(){this.justMoved=!0},f=function(t){0===e(t.target).closest(this.menu).length&&(t.preventDefault(),t.stopPropagation(),u.call(this,t,!0))},h=function(t){"aria-expanded"===t.originalEvent.attrName&&"false"===t.originalEvent.newValue&&e(t.target).hasClass(this.settings.openClass)&&(t.preventDefault(),t.stopPropagation(),u.call(this,t,!0))},d=function(t){P(this.focusTimeoutID);var s=e(t.target),a=s.closest("."+this.settings.panelClass);s.addClass(this.settings.focusClass),this.justFocused=!this.mouseFocused||!this.settings.openOnMouseover&&this.mouseFocused,this.mouseFocused=!1,this.justFocused&&this.panels.not(a).filter("."+this.settings.openClass).length&&u.call(this,t)},g=function(s){this.justFocused=!1;var a=this,n=e(s.target),i=n.closest("."+this.settings.topNavItemClass);n.removeClass(this.settings.focusClass),t.cvox?a.focusTimeoutID=A(function(){t.cvox.Api.getCurrentNode(function(e){i.has(e).length?P(a.focusTimeoutID):a.focusTimeoutID=A(function(e,t,s){u.call(e,t,s)},275,a,s,!0)})},25):a.focusTimeoutID=A(function(){a.mouseFocused&&null===s.relatedTarget||u.call(a,s,!0)},300)},p=function(t){var s,n,i,o,c,f,h=this.constructor===a?this:l(this),d=h.settings,g=e(e(this).is("."+d.hoverClass+":tabbable")?this:t.target),p=h.menu,m=h.topnavitems,b=g.closest("."+d.topNavItemClass),C=p.find(":tabbable"),v=g.hasClass(d.panelClass)?g:g.closest("."+d.panelClass),x=v.find("."+d.panelGroupClass),y=g.closest("."+d.panelGroupClass),D=t.keyCode||t.which,T=!1,M=N.keyMap[t.keyCode]||"",k=1===b.length&&0===v.length;if(!g.is("input:focus, select:focus, textarea:focus, button:focus")){switch(g.is("."+d.hoverClass+":tabbable")&&e("html").off("keydown.accessible-megamenu"),D){case N.ESCAPE:this.mouseFocused=!1,u.call(h,t,!0);break;case N.DOWN:t.preventDefault(),this.mouseFocused=!1,k?(u.call(h,t),T=1===b.find("."+d.panelClass+" :tabbable:first").focus().length):T=1===C.filter(":gt("+C.index(g)+"):first").focus().length,!T&&w&&(t.ctrlKey||t.metaKey)&&(C=e(":tabbable"),i=C.index(g),T=1===e(":tabbable:gt("+e(":tabbable").index(g)+"):first").focus().length);break;case N.UP:t.preventDefault(),this.mouseFocused=!1,k&&g.hasClass(d.openClass)?(u.call(h,t,!0),s=m.filter(":lt("+m.index(b)+"):last"),s.children("."+d.panelClass).length&&(T=1===s.find("[aria-expanded]").attr("aria-expanded","true").addClass(d.openClass).filter("."+d.panelClass).attr("aria-hidden","false").find(":tabbable:last").focus())):k||(T=1===C.filter(":lt("+C.index(g)+"):last").focus().length),!T&&w&&(t.ctrlKey||t.metaKey)&&(C=e(":tabbable"),i=C.index(g),T=1===e(":tabbable:lt("+e(":tabbable").index(g)+"):first").focus().length);break;case N.RIGHT:t.preventDefault(),this.mouseFocused=!1,k?T=1===m.filter(":gt("+m.index(b)+"):first").find(":tabbable:first").focus().length:(x.length&&y.length&&(T=1===x.filter(":gt("+x.index(y)+"):first").find(":tabbable:first").focus().length),T||(T=1===b.find(":tabbable:first").focus().length));break;case N.LEFT:t.preventDefault(),this.mouseFocused=!1,k?T=1===m.filter(":lt("+m.index(b)+"):last").find(":tabbable:first").focus().length:(x.length&&y.length&&(T=1===x.filter(":lt("+x.index(y)+"):last").find(":tabbable:first").focus().length),T||(T=1===b.find(":tabbable:first").focus().length));break;case N.TAB:this.mouseFocused=!1,i=C.index(g),t.shiftKey&&k&&g.hasClass(d.openClass)?(u.call(h,t,!0),s=m.filter(":lt("+m.index(b)+"):last"),s.children("."+d.panelClass).length&&(T=s.children().attr("aria-expanded","true").addClass(d.openClass).filter("."+d.panelClass).attr("aria-hidden","false").find(":tabbable:last").focus())):t.shiftKey&&i>0?T=1===C.filter(":lt("+i+"):last").focus().length:!t.shiftKey&&i<C.length-1?T=1===C.filter(":gt("+i+"):first").focus().length:w&&(C=e(":tabbable"),i=C.index(g),T=t.shiftKey?1===e(":tabbable:lt("+e(":tabbable").index(g)+"):last").focus().length:1===e(":tabbable:gt("+e(":tabbable").index(g)+"):first").focus().length),T&&t.preventDefault();break;case N.SPACE:case N.ENTER:if(!k)return!0;t.preventDefault(),r.call(h,t);break;default:if(P(this.keydownTimeoutID),I+=M!==I?M:"",0===I.length)return;for(this.keydownTimeoutID=A(function(){I=""},E),C=k&&!g.hasClass(d.openClass)?C.filter(":not(."+d.panelClass+" :tabbable)"):b.find(":tabbable"),t.shiftKey&&(C=e(C.get().reverse())),i=0;i<C.length;i++)if(o=C.eq(i),o.is(g)){n=1===I.length?i+1:i;break}for(f=new RegExp("^"+I.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),"i"),i=n;i<C.length;i++)if(o=C.eq(i),c=e.trim(o.text()),f.test(c)){T=!0,o.focus();break}if(!T)for(i=0;i<n;i++)if(o=C.eq(i),c=e.trim(o.text()),f.test(c)){o.focus();break}}h.justFocused=!1}},m=function(t){(e(t.target).closest(this.settings.panelClass)||e(t.target).closest(":focusable").length)&&(this.mouseFocused=!0,e(t.target).closest(this.settings.menuClass)&&e("html").on("keydown.accessible-megamenu",e.proxy(p,t.target))),P(this.mouseTimeoutID),this.mouseTimeoutID=A(function(){P(this.focusTimeoutID)},1)},b=function(t){P(this.mouseTimeoutID);var s=this;s.settings.openOnMouseover&&(this.mouseTimeoutID=A(function(){e(t.target).addClass(s.settings.hoverClass),u.call(s,t),e(t.target).closest(s.settings.menuClass)&&e("html").on("keydown.accessible-megamenu",e.proxy(p,t.target))},this.settings.openDelay))},C=function(t){P(this.mouseTimeoutID);var s=this;s.settings.openOnMouseover&&(e(t.target).removeClass(s.settings.hoverClass),s.mouseTimeoutID=A(function(){u.call(s,t,!0)},this.settings.closeDelay),e(t.target).is(":tabbable")&&e("html").off("keydown.accessible-megamenu"))},v=function(){var e="true"===this.toggleButton.attr("aria-expanded");this.toggleButton.attr({"aria-expanded":!e,"aria-pressed":!e})},x=function(t){var s=this.menu;t?(e("html").off("mouseup.outside-accessible-megamenu, touchend.outside-accessible-megamenu, mspointerup.outside-accessible-megamenu,  pointerup.outside-accessible-megamenu"),s.find("[aria-expanded]."+this.settings.panelClass).off("DOMAttrModified.accessible-megamenu")):(e("html").on("mouseup.outside-accessible-megamenu, touchend.outside-accessible-megamenu, mspointerup.outside-accessible-megamenu,  pointerup.outside-accessible-megamenu",e.proxy(f,this)),s.find("[aria-expanded=true]."+this.settings.panelClass).on("DOMAttrModified.accessible-megamenu",e.proxy(h,this)))},y=function(){var t=this.menu,a=this.toggleButton;t.on("focusin.accessible-megamenu",":focusable, ."+this.settings.panelClass,e.proxy(d,this)).on("focusout.accessible-megamenu",":focusable, ."+this.settings.panelClass,e.proxy(g,this)).on("keydown.accessible-megamenu",e.proxy(p,this)).on("mouseover.accessible-megamenu",e.proxy(b,this)).on("mouseout.accessible-megamenu",e.proxy(C,this)).on("mousedown.accessible-megamenu",e.proxy(m,this)).on("click.accessible-megamenu",e.proxy(r,this)),a.on("click.accessible-megamenu",e.proxy(v,this)),M&&t.on("touchmove.accessible-megamenu",e.proxy(c,this)),e(s.activeElement).closest(t).length&&e(s.activeElement).trigger("focusin.accessible-megamenu")},D=function(){var e=this.menu,t=this.toggleButton;e.off(".accessible-megamenu"),e.find("[aria-expanded=true]."+this.settings.panelClass).length&&x.call(this,!0),t.off(".accessible-megamenu")},{constructor:a,init:function(){var t=this.settings,s=e(this.element),a=s.children("ol,ul").first(),n=a.children(),i=s.children("button").first();this.start(t,s,a,n,i)},start:function(t,s,a,n,i){var l=this;this.settings=t,this.menu=a,this.topnavitems=n,this.toggleButton=i,s.attr("role","navigation"),o.call(l,a),a.addClass(t.menuClass),a.addClass(["js",t.menuClass].join("-")),n.each(function(s,a){var n,i;a=e(a),a.addClass(t.topNavItemClass),n=a.find(":tabbable:first"),i=a.children(":not(:tabbable):last"),o.call(l,n),i.length&&(o.call(l,i),n.attr({role:"button","aria-controls":i.attr("id"),"aria-expanded":!1,tabindex:0}),i.attr({role:"region","aria-expanded":!1,"aria-hidden":!0}).addClass(t.panelClass).not("[aria-labelledby]").attr("aria-labelledby",n.attr("id")))}),this.panels=a.find("."+t.panelClass),a.find("hr").attr("role","separator"),i.addClass(t.toggleButtonClass),i.attr({"aria-expanded":!1,"aria-pressed":!1,"aria-controls":a.attr("id")}),y.call(this)},destroy:function(){this.menu.removeClass(["js",this.settings.menuClass].join("-")),D.call(this,!0)},getDefaults:function(){return this._defaults},getOption:function(e){return this.settings[e]},getAllOptions:function(){return this.settings},setOption:function(e,t,s){this.settings[e]=t,s&&this.init()}}),e.fn[k]=function(t){return this.each(function(){var s=e.data(this,"plugin_"+k);s?"function"==typeof s[t]&&s[t].apply(s,Array.prototype.slice.call(arguments,1)):e.data(this,"plugin_"+k,new e.fn[k].AccessibleMegaMenu(this,t))})},e.fn[k].AccessibleMegaMenu=a,e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(s){return!!e.data(s,t)}}):function(t,s,a){return!!e.data(t,a[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var s=e.attr(t,"tabindex"),a=isNaN(s);return(a||s>=0)&&i(t,!a)}})})(jQuery,window,document),$("nav:first").accessibleMegaMenu({uuidPrefix:"accessible-megamenu",menuClass:"nav-menu",topNavItemClass:"nav-item",panelClass:"sub-nav",panelGroupClass:"sub-nav-group",hoverClass:"hover",focusClass:"focus",openClass:"open"});